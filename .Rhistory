25,    19, "black",
26,    19, "black",
27,    19, "black",
28,    19, "orange",
29,    19, "black",
8,     20, "black",
9,     20, "orange",
10,    20, "orange",
11,    20, "black",
12,    20, "beige",
13,    20, "beige",
14,    20, "beige",
15,    20, "beige",
16,    20, "beige",
17,    20, "beige",
18,    20, "beige",
19,    20, "beige",
20,    20, "beige",
21,    20, "beige",
22,    20, "beige",
23,    20, "beige",
24,    20, "beige",
25,    20, "beige",
26,    20, "beige",
27,    20, "black",
28,    20, "orange",
29,    20, "orange",
30,    20, "black",
8,     21, "black",
9,     21, "orange",
10,    21, "black",
11,    21, "beige",
12,    21, "beige",
13,    21, "beige",
14,    21, "beige",
15,    21, "beige",
16,    21, "beige",
17,    21, "black",
18,    21, "black",
19,    21, "beige",
20,    21, "black",
21,    21, "black",
22,    21, "beige",
23,    21, "beige",
24,    21, "beige",
25,    21, "beige",
26,    21, "beige",
27,    21, "beige",
28,    21, "black",
29,    21, "orange",
30,    21, "black",
7,     22, "black",
8,     22, "orange",
9,     22, "orange",
10,    22, "black",
11,    22, "beige",
12,    22, "beige",
13,    22, "beige",
14,    22, "beige",
15,    22, "beige",
16,    22, "beige",
17,    22, "black",
18,    22, "beige",
19,    22, "black",
20,    22, "beige",
21,    22, "black",
22,    22, "beige",
23,    22, "beige",
24,    22, "beige",
25,    22, "beige",
26,    22, "beige",
27,    22, "beige",
28,    22, "black",
29,    22, "orange",
30,    22, "orange",
31,    22, "black",
6,     23, "black",
7,     23, "black",
8,     23, "orange",
9,     23, "orange",
10,    23, "black",
11,     23, "beige",
12,     23, "beige",
13,     23, "beige",
14,     23, "beige",
15,     23, "beige",
16,     23, "beige",
17,     23, "beige",
18,     23, "beige",
19,     23, "beige",
20,     23, "beige",
21,     23, "beige",
22,     23, "beige",
23,     23, "beige",
24,     23, "beige",
25,     23, "beige",
26,     23, "beige",
27,     23, "beige",
28,     23, "black",
29,     23, "orange",
30,     23, "orange",
31,     23, "black",
32,     23, "black",
5,      24, "black",
6,      24, "beige",
7,      24, "black",
8,      24, "orange",
9,      24, "orange",
10,     24, "black",
11,     24, "beige",
12,     24, "beige",
13,     24, "black",
14,     24, "yellow",
15,     24, "yellow",
16,     24, "black",
17,     24, "beige",
18,     24, "beige",
19,     24, "black",
20,     24, "beige",
21,     24, "beige",
22,     24, "black",
23,     24, "yellow",
24,     24, "yellow",
25,     24, "black",
26,     24, "beige",
27,     24, "beige",
28,     24, "black",
29,     24, "orange",
30,     24, "orange",
31,     24, "black",
32,     24, "beige",
33,     24, "black",
5,      25, "black",
6,      25, "beige",
7,      25, "black",
8,      25, "orange",
9,      25, "orange",
10,     25, "black",
11,     25, "beige",
12,     25, "black",
13,     25, "yellow",
14,     25, "black",
15,     25, "black",
16,     25, "yellow",
17,     25, "black",
18,     25, "beige",
19,     25, "beige",
20,     25, "beige",
21,     25, "black",
22,     25, "yellow",
23,     25, "black",
24,     25, "black",
25,     25, "yellow",
26,     25, "black",
27,     25, "beige",
28,     25, "black",
29,     25, "orange",
30,     25, "orange",
31,     25, "black",
32,     25, "beige",
33,     25, "black",
5,      26, "black",
6,      26, "beige",
7,      26, "black",
8,      26, "orange",
9,      26, "orange",
10,     26, "black",
11,     26, "beige",
12,     26, "black",
13,     26, "black",
14,     26, "black",
15,     26, "black",
16,     26, "black",
17,     26, "black",
18,     26, "beige",
19,     26, "beige",
20,     26, "beige",
21,     26, "black",
22,     26, "black",
23,     26, "black",
24,     26, "black",
25,     26, "black",
26,     26, "black",
27,     26, "beige",
28,     26, "black",
29,     26, "orange",
30,     26, "orange",
31,     26, "black",
32,     26, "beige",
33,     26, "black",
6,      27, "black",
7,      27, "black",
8,      27, "orange",
9,      27, "orange",
10,     27, "black",
11,     27, "beige",
13,     27, "black",
16,     27, "black",
18,     27, "beige",
19,     27, "beige",
20,     27, "beige",
22,     27, "black",
25,     27, "black",
27,     27, "beige",
28,     27, "black",
29,     27, "orange",
30,     27, "orange",
31,     27, "black",
32,     27, "black",
7,      28, "black",
8,      28, "orange",
9,      28, "orange",
10,     28, "black",
11,     28, "beige",
18,     28, "beige",
19,     28, "beige",
20,     28, "beige",
27,     28, "beige",
28,     28, "black",
29,     28, "orange",
30,     28, "orange",
31,     28, "black",
3,      29, "black",
4,      29, "black",
5,      29, "black",
7,      29, "black",
8,      29, "orange",
9,      29, "orange",
10,     29, "black",
11,     29, "beige",
12,     29, "black",
17,     29, "black",
18,     29, "beige",
19,     29, "black",
20,     29, "beige",
21,     29, "black",
26,     29, "black",
27,     29, "beige",
28,     29, "black",
29,     29, "orange",
30,     29, "orange",
31,     29, "black",
33,     29, "black",
34,     29, "black",
35,     29, "black",
1,      30, "black",
2,      30, "black",
3,      30, "black",
4,      30, "orange",
5,      30, "orange",
6,      30, "black",
7,      30, "black",
8,      30, "orange",
9,      30, "orange",
10,     30, "orange",
11,     30, "black",
12,     30, "beige",
13,     30, "black",
14,     30, "black",
15,     30, "black",
16,     30, "black",
17,     30, "beige",
18,     30, "black",
19,     30, "orange",
20,     30, "black",
21,     30, "beige",
22,     30, "black",
23,     30, "black",
24,     30, "black",
25,     30, "black",
26,     30, "beige",
27,     30, "black",
28,     30, "orange",
29,     30, "orange",
30,     30, "orange",
31,     30, "black",
32,     30, "black",
33,     30, "orange",
34,     30, "orange",
35,     30, "black",
36,     30, "black",
37,     30, "black",
1,      31, "black",
2,      31, "orange",
3,      31, "black",
4,      31, "orange",
5,      31, "orange",
6,      31, "black",
7,      31, "yellow",
8,      31, "black",
9,      31, "orange",
10,     31, "orange",
11,     31, "orange",
12,     31, "black",
13,     31, "orange",
14,     31, "black",
15,     31, "beige",
16,     31, "beige",
17,     31, "black",
18,     31, "orange",
19,     31, "orange",
20,     31, "orange",
21,     31, "black",
22,     31, "beige",
23,     31, "beige",
24,     31, "black",
25,     31, "orange",
26,     31, "black",
27,     31, "orange",
28,     31, "orange",
29,     31, "orange",
30,     31, "black",
31,     31, "yellow",
32,     31, "black",
33,     31, "orange",
34,     31, "orange",
35,     31, "black",
36,     31, "orange",
37,     31, "black",
1,      32, "black",
2,      32, "orange",
3,      32, "orange",
4,      32, "orange",
5,      32, "black",
6,      32, "yellow",
7,      32, "yellow",
8,      32, "black",
9,      32, "orange",
10,     32, "orange",
11,     32, "orange",
12,     32, "black",
13,     32, "orange",
14,     32, "orange",
15,     32, "black",
16,     32, "black",
17,     32, "orange",
18,     32, "orange",
19,     32, "orange",
20,     32, "orange",
21,     32, "orange",
22,     32, "black",
23,     32, "black",
24,     32, "orange",
25,     32, "orange",
26,     32, "black",
27,     32, "orange",
28,     32, "orange",
29,     32, "orange",
30,     32, "black",
31,     32, "yellow",
32,     32, "yellow",
33,     32, "black",
34,     32, "orange",
35,     32, "orange",
36,     32, "orange",
37,     32, "black",
1,      33, "black",
2,      33, "orange",
3,      33, "orange",
4,      33, "orange",
5,      33, "black",
6,      33, "yellow",
7,      33, "yellow",
8,      33, "yellow",
9,      33, "black",
10,     33, "orange",
11,     33, "orange",
12,     33, "orange",
13,     33, "orange",
14,     33, "orange",
15,     33, "orange",
16,     33, "orange",
17,     33, "orange",
18,     33, "orange",
19,     33, "orange",
20,     33, "orange",
21,     33, "orange",
22,     33, "orange",
23,     33, "orange",
24,     33, "orange",
25,     33, "orange",
26,     33, "orange",
27,     33, "orange",
28,     33, "orange",
29,     33, "black",
30,     33, "yellow",
31,     33, "yellow",
32,     33, "yellow",
33,     33, "black",
34,     33, "orange",
35,     33, "orange",
36,     33, "orange",
37,     33, "black",
2,      34, "black",
3,      34, "orange",
4,      34, "orange",
5,      34, "orange",
6,      34, "black",
7,      34, "black",
8,      34, "yellow",
9,      34, "yellow",
10,     34, "black",
11,     34, "black",
12,     34, "orange",
13,     34, "orange",
14,     34, "orange",
15,     34, "orange",
16,     34, "orange",
17,     34, "orange",
18,     34, "orange",
19,     34, "orange",
20,     34, "orange",
21,     34, "orange",
22,     34, "orange",
23,     34, "orange",
24,     34, "orange",
25,     34, "orange",
26,     34, "orange",
27,     34, "black",
28,     34, "black",
29,     34, "yellow",
30,     34, "yellow",
31,     34, "black",
32,     34, "black",
33,     34, "orange",
34,     34, "orange",
35,     34, "orange",
36,     34, "black",
2,      35, "black",
3,      35, "orange",
4,      35, "orange",
5,      35, "orange",
6,      35, "orange",
7,      35, "black",
8,      35, "yellow",
9,      35, "yellow",
10,     35, "yellow",
11,     35, "yellow",
12,     35, "black",
13,     35, "orange",
14,     35, "orange",
15,     35, "orange",
16,     35, "orange",
17,     35, "orange",
18,     35, "orange",
19,     35, "orange",
20,     35, "orange",
21,     35, "orange",
22,     35, "orange",
23,     35, "orange",
24,     35, "orange",
25,     35, "orange",
26,     35, "black",
27,     35, "yellow",
28,     35, "yellow",
29,     35, "yellow",
30,     35, "yellow",
31,     35, "black",
32,     35, "orange",
33,     35, "orange",
34,     35, "orange",
35,     35, "orange",
36,     3
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(psych)
library(skimr) # データセットの要約を詳細に確認するため
library(knitr)
library(janitor)
bfi_a <- bfi %>%
select(A1:A5,gender,education,age) %>%
as_tibble()
bfi_a
bfi_a <-
bfi_a %>%
mutate_at(c("gender", "education"), factor) %>%
mutate(gender = fct_recode(gender, male   = "1",
female = "2"),
education = fct_recode(education, "HS" = "1",
"finished HS" = "2",
"some college" = "3",
"college graduate" = "4",
"graduate degree" = "5"
)
)
bfi_a <- bfi_a %>%
mutate(A1r = recode(A1, `1` = 6, `2` = 5, `3` = 4,
`4` = 3, `5` = 2, `6` = 1),
total_a = A1r + A2 + A3 + A4 + A5)
# 確認
bfi_a %>%
select(A1, A1r, A2:A5, total_a)
bfi %>%
nest(data = -c(gender, education)) %>%
mutate(freq =
map(data, ~ tabyl(.x, A1))) %>%
select(-data) %>%
unnest(cols = c(freq)) %>%
drop_na(education) %>%
as_tibble()
bfi_l <-
bfi %>%
as_tibble() %>%                    # tibble形式に変換
select(gender,education,A1,A2) %>% # 変数を選択
drop_na() %>%                      # 欠損は削除
pivot_longer(A1:A2,            # longにする変数A1:A2を指定
names_to = "variables",
values_to = "score")
bfi_l_nest <-
bfi_l %>%
nest(data = score) # 層別にする変数を指定; -c(gender,education,variables)
bfi_l_nest %>% count(variables,gender,education)
